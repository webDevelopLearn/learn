也许我们在使用选择器的时候会经常碰到一种麻烦的情况：冲突。如果两个一样的选择器该选用哪个？如果两个不同的选择器都指向同一个元素那该选哪个？

下面我们要讨论的就是解决这个问题的办法。

# 特殊性-----------

上面提到了，如果有两个或者多个不同的选择器所匹配到的都是同一个元素，而且声明发生冲突，那该选择哪个？

这就要说到选择器的特殊性了。

对于不同的选择器规则，用户代理（User Agent）会计算他们的特殊性，特殊性最高的声明属性就可以突围而出，获得优先在文档显示的资格。

那么问题来了，怎么计算特殊性呢？

下面有几条规则：

1、选择器中的各个ID属性值，特殊性增加0，1，0，0。

2、选择器中的各个类属性值、属性选择或者伪类，特殊性增加0，0，1，0。

3、选择器中的各个元素和伪元素，特殊性增加0，0，0，1。

4、结合符和通配选择器的特殊性为0，0，0，0。

其中1越往前特殊性越大。

注意要特别区分的是第二条和第一条，因为很容易把ID选择器和指定ID属性的属性选择器搞混。这两者的特殊性可不一样。后者的本质是属性选择器。

例如下面的例子：

```
<style>
    *{color: #blue;}
    h1{
        color:yellow;
    }
    #text{
        color:green;
    }
    p[id="text"]{
        color:red;
    }
</style>

    <h1>我是一行文字呀</h1>
    <p id="text">我是来测试我能被谁改变样式的</p>

```

效果如下：

![0042](/screenshots/0043.jpg)

我们发现，通配选择器的样式没有显示出来，而指向同一个元素的两个选择器，只有ID选择器的样式显示出来了。而指向ID属性的属性选择器的样式就没有显示出来。

那么为什么没“1，0，0，0”呢？

不是没有，而是这就是内联样式选择器的特殊性。它比上面所有声明的特殊性都要高。

## 重要性---------
这里说的重要性，是特指某个声明很重要，超过了其他的声明。那怎么表示这个声明很重要？只要在声明的最后，而且必须是最后，也就是分号之前，加上!important的标记就可以了。

万一重要声明之间发生特殊性的冲突，也只会在重要声明寻求解决方法，而不会波及非重要声明。万一重要声明和非重要声明发生特殊性冲突，那么重要声明永远占据上风。



# 继承-----------

上面我们提到，通配选择器和结合符的特殊性是0。即使是0，也是有特殊性的，它就比没有特殊性的优先级要高。

没有特殊性的譬如是继承的值。下面将谈到继承。

先来一个例子来演示什么是继承。

```
<style>
    h1{
        color:yellow;
    }
    p#text{
        color:red;
    }
 </style>

<h1>我是一行文字呀<em>我是h1里面的文字em哟<p>我是em里的文字p哟</p></em></h1>
       <p id="text">我是来测试我能被谁改变样式的</p>
```

效果如下：

![0042](/screenshots/0044.jpg)

我们可以看到，h1里面的所有元素字体都变成了黄色。这就是继承，样式不仅会应用到指定的某个元素，还会应用到这个元素的后代元素，除非碰到某个不能继承的元素。

例如a元素，这就是一个无法继承父类的元素。为什么？

![0042](/screenshots/0045.jpg)

通过上图我们可以知道，a元素有个默认样式，是伪类，特殊性是0，0，1，0，大于h1的特殊性，所以无法被覆盖。当然了，还有一些是无法继承的元素，例如border，边距等等。

## 有特殊性和没有特殊性是有区别的----------

我们再来探讨一下为什么说继承的值没有特殊性，还有没有特殊性和特殊性为0有什么区别？

先来就上面这句话来演示一下。

```
<style>
    *{color: blue;}
    h1{
        color:yellow;
    }
</style>

<h1>我是一行文字呀<em>我是h1里面的文字哟</em></h1>
       <p>我是来测试我能被谁改变样式的</p>
```

效果如下：

![0042](/screenshots/0046.jpg)

我们发现，h1里面的子元素em被通配选择器的样式给覆盖了，跟我们设想的h1覆盖所有后代元素不一致。

这就是因为继承的值是没有特殊性的。而通配选择器的特殊性为0，是比没有特殊性要强。


# 层叠------------

我们再次回到开头的那个问题，如果两个选择器一样，即特殊性一样的两个声明用在同一个元素上该怎么办呢？

譬如以下代码：

```
p{color:yellow;}
p{color:red;}
```

浏览器会选择哪个？

在CSS2.1里，有个规则叫做层叠规则，意思就是把多个样式来源叠加在一起，根据优先级确定最终结果，也就是应用哪个样式。

首先，我们要说一下有哪几种来源。分别有创作人员的样式（也就是编写CSS样式表的你啦），有读者样式（也就是浏览器用户自定义的样式），还有用户代理的样式（也就是浏览器默认样式啦）。

然后我们来说一下层叠规则有哪几条。

**一、按声明的权重和来源排序。**
```
上面我们提到重要性。标志重要性的权重是最高的。在重要性里，读者的声明权重最高，一般情况下就是创作人员的声明权重大于读者声明。而任何声明都大于用户代理的声明。我们可以这样排序：读者的重要声明 > 创作人员的重要声明 > 创作人员的普通声明 > 读者的普通声明 > 用户代理声明。
```
**二、按特殊性排序。不用说，特殊性高的自然比特殊性低的权重大。**

**三、如果以上声明的权重、来源和特殊性都一致，则按出现顺序排序。越往后权重越大。如果有导入样式表，则主样式表比导入样式表靠后。**


根据上面规则，我们推荐链接伪类样式按照“LVHA”的顺序排序。即“:link”、“:visited”、“:hover”、“:active”。因为这通常是我们期望的效果。这四个伪类的特殊性、声明权重和来源都是一致的，就按顺序来决定优先级。所以:active出现在最后，它可以和前面三个匹配。如果按照其他顺序排列，我们可以想象出来的效果是不一样的。


譬如把顺序改成“:visited”、“:hover”、“:link”、“:active”。那么如果这个链接是未访问的，就无法匹配前面两个伪类了。
```
